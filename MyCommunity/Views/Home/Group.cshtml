@model MyCommunity.ViewModels.GroupViewModel
<script>
    $(function () {
        $('#mnu').accordion({
            heightStyle: "content",
            collapsible:true
        });
        $("#newEventPopup").dialog({
            autoOpen: false,
            modal: true,
            width:375,
            height: 315,
            title:"Create an event",
            open: function (event, ui) {
                $(this).load("@Url.Action("CreateGroupEventPartial", new {id=@Model.Id})");
            }
        });
         $("#newEventButton").button().click(function () {
             $("#newEventPopup").dialog("open");
         });
         $('#submit').button().click(function (event) {
             event.preventDefault();
             var comment = $("#comment").val();
             $.ajax({
                 url: "/Home/CommentGroup",
                 type: "POST",
                 data: { "comment": comment,"id":@Model.Id},
            success: function (data) {
                var els = $("#comments").find('div');
                if (els.length > 4) {
                    els.last().remove();
                }
                $('#comments').prepend(data);
                $("#comment").val(null);
                
            },
            error: function (data) {
                alert('Oops. Something wnet wrong!');
            }
        });
             return false;
         });
     });
   
</script>
@{
    ViewBag.Title = "Group";
}

<h2>@Model.Name</h2>
<h3>@Model.Description</h3>
<table>
 <tr>
 <td style="width:300px;vertical-align:top;">
      <div id="mnu">
        <h3>Events</h3>
          <div>
 
    
              @foreach (var group in Model.Evts)
              {
                  <p>@Html.ActionLink(group.Value, "Event", new { id = group.Key })</p>
              }
    
              <button style="float:right" id="newEventButton">Create Event</button>
          </div>
          <h3>Members</h3>
      <div>
 
     @foreach (var group in Model.Members)
              {
                  <p>@group.Value</p>
              }
      </div>
          </div>
<div id="newEventPopup" title="Dialog Title"></div>
 </td>
     <td>
@using (Html.BeginForm("Comment", "Home"))
    {
        @Html.AntiForgeryToken()

        <fieldset>
            <legend>Post a comment</legend>
            <ol>
                <li>
                    
                    <textarea  name="comment " id="comment" rows="4" ></textarea>
                </li>
            </ol>
            <input id="submit" type="submit" value="Post" />
        </fieldset>
    }
     <div id="comments">
         @foreach (var comment in Model.Messages.Messages)
         {
             Html.RenderPartial("_MessagePartial", comment);
         }
     </div>
         </td></tr></table>